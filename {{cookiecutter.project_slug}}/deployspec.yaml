build_type: BUILD_GENERAL1_SMALL
publishGenericEnvVariables: true

deploy:
  phases:
    install:
      commands:
        - npm install -g aws-cdk@2.177.0
        - npm install
    build:
      commands:
        - cdk deploy --require-approval never --progress events --app "npx ts-node --prefer-ts-exts bin/{{ cookiecutter.module_name }}.ts" --outputs-file ./cdk-exports.json -v
        - seedfarmer metadata convert -f cdk-exports.json || true
destroy:
  phases:
    install:
      commands:
        - npm install -g aws-cdk@2.177.0
        - npm install
    build:
      commands:
        - cdk destroy --force --app "npx ts-node --prefer-ts-exts bin/{{ cookiecutter.module_name }}.ts"
